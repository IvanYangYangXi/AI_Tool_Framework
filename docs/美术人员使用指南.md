# 🎨 DCC工具管理器 - 美术人员使用指南

> 本指南专为美术同学编写，帮助您快速上手使用DCC工具管理器。

---

## 📋 目录

1. [工具简介](#工具简介)
2. [首次安装](#首次安装)
3. [日常使用流程](#日常使用流程)
4. [Maya连接设置](#maya连接设置)
5. [常见问题解答](#常见问题解答)

---

## 工具简介

**DCC工具管理器**是一个帮助美术同学管理和执行各种DCC软件（Maya、3ds Max、Blender等）工具脚本的桌面应用程序。

### 主要功能

| 功能 | 说明 |
|------|------|
| 🔄 自动更新 | 启动时自动检查并提示更新最新工具 |
| 📦 工具管理 | 浏览和搜索所有可用的工具脚本 |
| 🔗 DCC连接 | 一键连接到Maya等DCC软件 |
| ▶️ 远程执行 | 直接在DCC软件中执行工具，无需复制粘贴代码 |

### 界面预览

```
┌─────────────────────────────────────────────────────────────┐
│  Git状态: ✓ 已是最新版本    DCC连接: 已连接到 Maya    v1.0.0 │
├──────────────────────┬──────────────────────────────────────┤
│                      │                                      │
│   📁 可用工具         │   📝 工具详情                         │
│   ├─ Maya工具        │   ─────────────────────               │
│   │  └─ PrintSelection│   工具名称: PrintSelection           │
│   │  └─ MeshCleaner   │   版本: 1.0.0                        │
│   ├─ 3ds Max工具     │   描述: 获取并打印选中对象名称         │
│   ├─ Blender工具     │                                      │
│   └─ UE工具          │   ⚙️ 参数配置                         │
│                      │   ─────────────────────               │
│   [🔄 刷新工具列表]   │   (该工具无需配置参数)                │
│                      │                                      │
│                      │   🎮 执行控制                         │
│                      │   ─────────────────────               │
│                      │   [▶️ 在DCC中执行] [📝 生成脚本]       │
│                      │                                      │
│                      │   DCC连接: [Maya ▼] [🔗连接] [断开]   │
├──────────────────────┴──────────────────────────────────────┤
│  Git管理: [⬇️更新] [🔍检查] [📋日志]  │  操作日志            │
└─────────────────────────────────────────────────────────────┘
```

---

## 首次安装

### 步骤1：安装Git（如果还没有）

1. 访问 https://git-scm.com/downloads
2. 下载Windows版本并安装
3. 安装时一路点"Next"即可，使用默认设置

### 步骤2：克隆工具仓库

1. 在你想存放工具的位置创建一个文件夹（例如：`D:\ArtTools`）
2. 在该文件夹中右键，选择 **"Git Bash Here"**
3. 输入以下命令（请向技术同事获取实际仓库地址）：

```bash
git clone [仓库地址] AI_Tool_Framework
```

### 步骤3：运行工具管理器

方式一：双击运行
```
找到 AI_Tool_Framework\启动工具管理器.bat 双击运行
```

方式二：命令行运行
```bash
cd AI_Tool_Framework
python -m src.gui.lightweight_manager
```

---

## 日常使用流程

### 🌟 标准工作流程（每天开工时）

```
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│  1. 启动工具  │ ──▶ │  2. 检查更新  │ ──▶ │  3. 打开Maya │
│    管理器    │     │  (自动提示)   │     │              │
└──────────────┘     └──────────────┘     └──────────────┘
        │                                        │
        ▼                                        ▼
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│  6. 查看结果  │ ◀── │  5. 点击执行  │ ◀── │ 4. 设置Maya  │
│   (Maya中)   │     │              │     │   命令端口   │
└──────────────┘     └──────────────┘     └──────────────┘
```

### 详细步骤

#### 1️⃣ 启动工具管理器

双击 `启动工具管理器.bat` 或运行命令：
```
python -m src.gui.lightweight_manager
```

#### 2️⃣ 检查更新（自动）

- 启动时会自动检查是否有新版本
- 如果有更新，会弹出提示框
- **建议点击"立即更新"**以获取最新工具

#### 3️⃣ 打开Maya

正常启动你的Maya软件

#### 4️⃣ 在Maya中开启命令端口（重要！）

在Maya的脚本编辑器(Script Editor)中执行以下代码：

```python
import maya.cmds as cmds

# 关闭旧端口（如果存在）
if cmds.commandPort(':7001', query=True):
    cmds.commandPort(name=':7001', close=True)

# 开启新端口
cmds.commandPort(name=':7001', sourceType='python', echoOutput=False)
print('命令端口已开启: 7001')
```

> 💡 **提示**：可以把这段代码保存到Maya的启动脚本中，这样每次打开Maya就自动开启了。

#### 5️⃣ 在管理器中连接Maya

1. 在工具管理器右侧，找到"DCC连接"
2. 下拉菜单选择 **Maya**
3. 点击 **🔗 连接** 按钮
4. 看到"✓ 成功连接到Maya"表示连接成功

#### 6️⃣ 选择并执行工具

1. 在左侧"Maya工具"标签页中选择一个工具
2. 右侧会显示工具详情和参数配置
3. 根据需要调整参数
4. 点击 **▶️ 在DCC中执行**
5. 在Maya脚本编辑器中查看执行结果

---

## Maya连接设置

### 为什么需要开启命令端口？

命令端口就像Maya的一个"遥控接收器"，让外部程序可以向Maya发送指令。

### 一劳永逸的设置方法

将命令端口代码添加到Maya启动脚本，这样每次打开Maya就自动开启：

#### Windows路径：
```
C:\Users\[你的用户名]\Documents\maya\[Maya版本]\scripts\userSetup.py
```

#### 在userSetup.py中添加：
```python
import maya.cmds as cmds
import maya.utils

def setup_command_port():
    """启动时自动开启命令端口"""
    if cmds.commandPort(':7001', query=True):
        cmds.commandPort(name=':7001', close=True)
    cmds.commandPort(name=':7001', sourceType='python', echoOutput=False)
    print('✓ DCC工具管理器命令端口已开启: 7001')

# 延迟执行，确保Maya完全启动后再开启
maya.utils.executeDeferred(setup_command_port)
```

---

## 常见问题解答

### ❓ Q1: 点击"连接"后提示连接失败怎么办？

**原因**：Maya的命令端口没有开启

**解决方法**：
1. 确保Maya已经打开
2. 在Maya脚本编辑器中执行开启命令端口的代码
3. 重新点击"连接"

---

### ❓ Q2: 执行工具后Maya没有反应？

**检查步骤**：
1. 打开Maya的脚本编辑器（Window → General Editors → Script Editor）
2. 查看是否有错误信息或输出结果
3. 结果通常会打印在脚本编辑器的输出窗口中

---

### ❓ Q3: 启动时提示"Git仓库未找到"？

**原因**：工具管理器找不到Git仓库位置

**解决方法**：
1. 确保已经克隆了工具仓库
2. 设置环境变量 `AI_TOOL_REPO_PATH` 指向仓库路径

设置环境变量方法：
1. 右键"此电脑" → 属性 → 高级系统设置 → 环境变量
2. 新建用户变量：
   - 变量名：`AI_TOOL_REPO_PATH`
   - 变量值：`D:\ArtTools\AI_Tool_Framework`（你的实际路径）

---

### ❓ Q4: 如何更新到最新版本的工具？

**方法一**：使用工具管理器（推荐）
1. 点击底部的 **⬇️ 更新到最新版本** 按钮
2. 等待更新完成

**方法二**：手动Git命令
1. 打开Git Bash
2. 进入工具目录：`cd /d/ArtTools/AI_Tool_Framework`
3. 执行：`git pull`

---

### ❓ Q5: Maya报错"TypeError: a bytes-like object is required"？

**原因**：命令端口使用了不兼容的设置

**解决方法**：使用正确的命令端口配置（echoOutput=False）：

```python
import maya.cmds as cmds
if cmds.commandPort(':7001', query=True):
    cmds.commandPort(name=':7001', close=True)
cmds.commandPort(name=':7001', sourceType='python', echoOutput=False)
```

---

### ❓ Q6: 工具列表是空的？

**原因**：没有扫描到工具目录

**解决方法**：
1. 点击 **🔄 刷新工具列表** 按钮
2. 检查 `src/plugins/dcc/maya/` 目录下是否有工具
3. 确保每个工具目录下有 `config.json` 配置文件

---

## 📞 获取帮助

如果遇到本指南未覆盖的问题，请联系：
- **技术支持**：[联系技术同事]
- **问题反馈**：[在Git仓库提Issue]

---

## 🔖 快速参考卡片

```
┌─────────────────────────────────────────────────────────────┐
│                    快速参考卡片                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  🚀 启动管理器:  python -m src.gui.lightweight_manager      │
│                                                             │
│  🔌 Maya命令端口:                                           │
│     import maya.cmds as cmds                                │
│     cmds.commandPort(name=':7001', sourceType='python',     │
│                      echoOutput=False)                      │
│                                                             │
│  ⬇️ 手动更新:  git pull                                     │
│                                                             │
│  📁 工具目录:  src/plugins/dcc/maya/                        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

*文档版本: 1.0.0 | 最后更新: 2026-02-13*
